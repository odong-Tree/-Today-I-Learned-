# 210623: Stub, Mock

# 학습 내용

- TDD

<br>

## 테스트 더블 (Test Double)

- 실제 객체를 대신해서 테스트하는 모든 방법, Dummy, Fake Object, Stub, Mock 등이 있다.
- → 예를 들어 네트워크 API를 통해 어떤 정보를 받아서 수행하는 로직을 테스트할 때, 실제로 네트워크 API를 그대로 사용하면 테스팅은 네트워크 연결에 영향을 받기 때문에 항상 같은 조건에서 테스트가 이루어지지 못한다.
- 많은 테스트 더블이 있지만 테스트 더블들의 역할이 딱딱 나누어져 있는 것은 아니다. 서로가 서로의 특성을 조금씩 포괄한다.

### Dummy

- 객체는 전달되지만 사용되지 않는 객체
- 예를 들면 함수 파라미터에 전달되는 빈 객체 등이 있다.

### Fake

- 동작하는 구현을 가지고 있지만 실제 프로덕션에는 적합하지 않은 (혹은 동일하지 않은) 객체이다. 단순화된 버전의 동작을 제공하기도 한다.
- 예를 들어 인메모리 데이터 베이스가 있다.

### Stub

- 테스트에서 호출된 요청에 대해 미리 준비해둔 결과를 제공한다.
- 테스트를 위해 프로그래밍된 내용 이외에는 응답하지 않는다.

### Spy

- Stub의 역할을 가지면서 호출된 내용에 대해 약간의 정보를 기록한다.
- 테스트에서 확인하기 위한 정보이다.
- 예를 들면, 메일링 서비스에서 발송된 메일의 갯수를 기록

### Mock

- 호출에 대한 기대를 명세하고, 해당 내용에 따라 동작하도록 프로그래밍 된 객체이다.
- 다른 개발환경에서는 Mock 프레임워크들이 존재하는데 Xcode에서 사용할 수 있는 mock 프레임 워크는 아직 보지 못했다. 직접 만들어서 써야한다. Mock 객체를 만드는 걸 도와주는 플러그인등은 존재한다.

### [TDD에서 궁금한 것]

- 하나의 메서드를 테스트 하는 코드도 아주 다양하게 나올텐데 테스트 코드 자체가 어마어마한 양으로 쓰이는 것이 맞나?
- 네트워크 환경에 따라 달라지는 테스트를 일정하게 하기 위해서 Mock 객체를 사용한다. 그런데 네트워크와 연결이 되는지에 대한 확인은 테스트 코드로 하지 않는가?
- 어느정도까지 테스트를 해야할까? → 스펙에 있는 것들은 다 테스트가 필요, 경계값에 대한 테스트도 필요
- 테스트 커버리지?
- Mock, Stub 어떻게 만들어서 쓰나
- 커밋 단위는?

<br>

# 느낀점

- 역시 이론으로 접하는 것 보다 직접 프로젝트를 하면서 써보는게 빠른 것 같다. TDD도 경험해보고 BDD(Behaviour-Driven Development)도 접해봐야지.
- 요즘 코딩테스트가 재밌어서 자꾸 코테 문제 풀이에만 손이 가는 것 같다.